# Исправление ошибки "Supabase credentials not configured"

## Проблема:
В логах Netlify Functions видна ошибка: `Supabase credentials not configured`

Это означает, что переменные окружения не доступны в функциях.

## Решение:

### Вариант 1: Проверьте названия переменных (САМОЕ ВАЖНОЕ!)

В Netlify переменные окружения должны называться **ТОЧНО** так:

1. `SUPABASE_URL` (заглавные буквы, подчеркивание)
2. `SUPABASE_ANON_KEY` (заглавные буквы, подчеркивание)
3. `SUPABASE_SERVICE_KEY` (заглавные буквы, подчеркивание)

**НЕ используйте:**
- ❌ `supabase_url` (маленькие буквы)
- ❌ `Supabase_URL` (смешанный регистр)
- ❌ `SUPABASE-URL` (дефис)
- ❌ `SUPABASE URL` (пробел)

### Вариант 2: Передеплойте сайт

**ОБЯЗАТЕЛЬНО!** После добавления/изменения переменных окружения:

1. Netlify Dashboard → ваш сайт
2. **Deploys** → **Trigger deploy** → **Clear cache and deploy site**
3. Или сделайте новый commit в GitHub (если используете Git)

### Вариант 3: Проверьте значения переменных

1. Netlify → Site settings → Environment variables
2. Убедитесь, что значения правильные:
   - `SUPABASE_URL` = `https://xxxxx.supabase.co` (с https://!)
   - `SUPABASE_ANON_KEY` = длинный ключ (начинается с `eyJ...`)
   - `SUPABASE_SERVICE_KEY` = длинный ключ (начинается с `eyJ...`)

### Вариант 4: Проверьте scope переменных

При добавлении переменных в Netlify можно выбрать scope:
- **All scopes** (рекомендуется) - для всех деплоев
- **Production** - только для продакшена
- **Deploy previews** - только для preview

Убедитесь, что выбрано **All scopes** или **Production**.

## Пошаговая инструкция:

1. **Удалите старые переменные** (если есть с неправильными названиями)
2. **Добавьте новые переменные** с правильными названиями:
   - Key: `SUPABASE_URL`
   - Value: ваш URL из Supabase
   - Scope: All scopes
3. **Повторите для остальных двух переменных**
4. **Сохраните**
5. **Передеплойте сайт** (обязательно!)
6. **Проверьте логи** после передеплоя

## Проверка после исправления:

1. Зарегистрируйте пользователя
2. Проверьте логи: Functions → saveUser → View logs
3. Должно быть:
   - `Supabase URL: Установлен`
   - `Service Key: Установлен`
   - НЕ должно быть: `Supabase credentials not configured`

## Если не помогло:

1. Убедитесь, что используете правильный проект в Netlify
2. Проверьте, что функции задеплоены (Functions → должны быть видны getUsers и saveUser)
3. Попробуйте удалить и заново добавить переменные
4. Убедитесь, что передеплоили после добавления переменных

